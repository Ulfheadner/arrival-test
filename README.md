# Тестовый сервис

## Описание

Текст задания находится в файле *TASK_DESCRIPTION.md*

Aiohttp веб-сервер с бэкграунд таской, которая асинхронно читает с вебсокета сообщения 
и складывает их в Монгу

Запуск ```docker-compose up consumer --build```

Линтер ```black /path/to/folder/consumer```

## Настройка окружения

```MONGO_URL``` - Строка подключения к монге

```VEHICLE_WS_URL``` - Адрес вебсокета для чтения событий

```HOST``` - Домен вебсервера

```PORT``` - Порт вебсервера

```PAGE_SIZE``` - Количество объектов, получаемых за один раз

## API

Для получения списка прочитанных сообщений используется следующий запрос

```GET http://0.0.0.0:8000/events```

Пример ответа:

```
{
    "count": 50,
    "next_page": "/events?cursor=6260f05769c302ec761dfcbc&direction=next",
    "prev_page": "/events?cursor=6260f05769c302ec761dfc8b&direction=prev",
    "events": [
        {
            "_id": {
                "$oid": "6260f05769c302ec761dfc8b"
            },
            "component": "Zoomzone GPS Side Controller",
            "country": "Russia",
            "description": "dolorem illo voluptatem deleniti suscipit eum.",
            "model": "n77-481",
            "created_at": 1650520151.1452942
        },
        ...
    ]
}
```

## TODO

- Разделить запись и чтение Монги в разные реплики
- Доработать логгирование, добавить подробные эксепшны
- Добавить количество страниц в ответ
- Добавить возможность задавать размер страницы в запросе ```?limit=<int>```
- Разнести функции по классам
- Добавить возможность запуска без докера